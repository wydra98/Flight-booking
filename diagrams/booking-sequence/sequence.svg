<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="792px" preserveAspectRatio="none" style="width:1028px;height:792px;" version="1.1" viewBox="0 0 1028 792" width="1028px" zoomAndPan="magnify"><defs><filter height="300%" id="f7prrmk9h9nrk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="30" x2="30" y1="86.2969" y2="373.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="30" x2="30" y1="373.625" y2="401.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30" x2="30" y1="401.625" y2="705.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287" x2="287" y1="86.2969" y2="373.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="287" x2="287" y1="373.625" y2="401.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287" x2="287" y1="401.625" y2="705.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="504.5" y1="86.2969" y2="373.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="504.5" x2="504.5" y1="373.625" y2="401.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="504.5" y1="401.625" y2="705.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="837.5" x2="837.5" y1="86.2969" y2="373.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="837.5" x2="837.5" y1="373.625" y2="401.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="837.5" x2="837.5" y1="401.625" y2="705.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="965.5" x2="965.5" y1="86.2969" y2="373.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="965.5" x2="965.5" y1="373.625" y2="401.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="965.5" x2="965.5" y1="401.625" y2="705.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="82.9951">Client</text><ellipse cx="30.5" cy="13" fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,21 L30.5,48 M17.5,29 L43.5,29 M30.5,48 L17.5,63 M30.5,48 L43.5,63 " fill="none" filter="url(#f7prrmk9h9nrk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="8" y="717.0811">Client</text><ellipse cx="30.5" cy="730.3828" fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30.5,738.3828 L30.5,765.3828 M17.5,746.3828 L43.5,746.3828 M30.5,765.3828 L17.5,780.3828 M30.5,765.3828 L43.5,780.3828 " fill="none" filter="url(#f7prrmk9h9nrk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="238" y="82.9951">TripController</text><ellipse cx="287.5" cy="54" fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="283.5,42,289.5,37,287.5,42,289.5,47,283.5,42" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="238" y="717.0811">TripController</text><ellipse cx="287.5" cy="736.3828" fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="283.5,724.3828,289.5,719.3828,287.5,724.3828,289.5,729.3828,283.5,724.3828" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="457.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="464.5" y="70.9951">TripService</text><rect fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="457.5" y="704.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="464.5" y="724.0811">TripService</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="776.5" y="82.9951">RouteRepository</text><path d="M819.5,34 C819.5,24 837.5,24 837.5,24 C837.5,24 855.5,24 855.5,34 L855.5,60 C855.5,70 837.5,70 837.5,70 C837.5,70 819.5,70 819.5,60 L819.5,34 " fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M819.5,34 C819.5,44 837.5,44 837.5,44 C837.5,44 855.5,44 855.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="776.5" y="717.0811">RouteRepository</text><path d="M819.5,730.3828 C819.5,720.3828 837.5,720.3828 837.5,720.3828 C837.5,720.3828 855.5,720.3828 855.5,730.3828 L855.5,756.3828 C855.5,766.3828 837.5,766.3828 837.5,766.3828 C837.5,766.3828 819.5,766.3828 819.5,756.3828 L819.5,730.3828 " fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M819.5,730.3828 C819.5,740.3828 837.5,740.3828 837.5,740.3828 C837.5,740.3828 855.5,740.3828 855.5,730.3828 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="908.5" y="82.9951">TripsRepository</text><path d="M947.5,34 C947.5,24 965.5,24 965.5,24 C965.5,24 983.5,24 983.5,34 L983.5,60 C983.5,70 965.5,70 965.5,70 C965.5,70 947.5,70 947.5,60 L947.5,34 " fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M947.5,34 C947.5,44 965.5,44 965.5,44 C965.5,44 983.5,44 983.5,34 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="908.5" y="717.0811">TripsRepository</text><path d="M947.5,730.3828 C947.5,720.3828 965.5,720.3828 965.5,720.3828 C965.5,720.3828 983.5,720.3828 983.5,730.3828 L983.5,756.3828 C983.5,766.3828 965.5,766.3828 965.5,766.3828 C965.5,766.3828 947.5,766.3828 947.5,756.3828 L947.5,730.3828 " fill="#FEFECE" filter="url(#f7prrmk9h9nrk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M947.5,730.3828 C947.5,740.3828 965.5,740.3828 965.5,740.3828 C965.5,740.3828 983.5,740.3828 983.5,730.3828 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="275.5,113.4297,285.5,117.4297,275.5,121.4297,279.5,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30.5" x2="281.5" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="37.5" y="112.3638">GET '/trips?src=?,dst=?,rest=...'</text><polygon fill="#A80036" points="492.5,142.5625,502.5,146.5625,492.5,150.5625,496.5,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287.5" x2="498.5" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="294.5" y="141.4966">Find Trips based on params</text><polygon fill="#A80036" points="825.5,171.6953,835.5,175.6953,825.5,179.6953,829.5,175.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="831.5" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="309" x="511.5" y="170.6294">SELECT * FROM routes WHERE src=? AND dst=?</text><polygon fill="#A80036" points="515.5,200.8281,505.5,204.8281,515.5,208.8281,511.5,204.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="509.5" x2="836.5" y1="204.8281" y2="204.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="521.5" y="199.7622">Return array of found Routes</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="546.5" y1="249.0938" y2="249.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546.5" x2="546.5" y1="249.0938" y2="262.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="505.5" x2="546.5" y1="262.0938" y2="262.0938"/><polygon fill="#A80036" points="515.5,258.0938,505.5,262.0938,515.5,266.0938,511.5,262.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="511.5" y="228.895">For each route: create (if possible) Trip</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="306" x="515.5" y="244.0278">based on parameters (without Passenger fields)</text><polygon fill="#A80036" points="298.5,287.2266,288.5,291.2266,298.5,295.2266,294.5,291.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292.5" x2="503.5" y1="291.2266" y2="291.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="304.5" y="286.1606">Return array of Trips</text><polygon fill="#A80036" points="41.5,316.3594,31.5,320.3594,41.5,324.3594,37.5,320.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="286.5" y1="320.3594" y2="320.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="47.5" y="315.2935">Respond 200 with array of Trips</text><rect fill="#FFFFFF" filter="url(#f7prrmk9h9nrk)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="110" x="5" y="328.3594"/><polygon fill="#EEEEEE" points="5,328.3594,71,328.3594,71,335.3594,61,345.3594,5,345.3594,5,328.3594" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="18" y="342.4263">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="11" y="361.4263">Array&lt;TripDto&gt;</text><polygon fill="#A80036" points="275.5,433.8906,285.5,437.8906,275.5,441.8906,279.5,437.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30.5" x2="281.5" y1="437.8906" y2="437.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="37.5" y="417.6919">POST '/trips' with body of chosen Trip</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="41.5" y="432.8247">+ passengers info</text><rect fill="#FFFFFF" filter="url(#f7prrmk9h9nrk)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="134" x="5" y="445.8906"/><polygon fill="#EEEEEE" points="5,445.8906,71,445.8906,71,452.8906,61,462.8906,5,462.8906,5,445.8906" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="18" y="459.9575">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="11" y="478.9575">BookingRequestDto</text><polygon fill="#A80036" points="492.5,508.2891,502.5,512.2891,492.5,516.2891,496.5,512.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="287.5" x2="498.5" y1="512.2891" y2="512.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="294.5" y="507.2231">Save received Trip</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="546.5" y1="541.4219" y2="541.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546.5" x2="546.5" y1="541.4219" y2="554.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="505.5" x2="546.5" y1="554.4219" y2="554.4219"/><polygon fill="#A80036" points="515.5,550.4219,505.5,554.4219,515.5,558.4219,511.5,554.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="511.5" y="536.356">Process Trip</text><polygon fill="#A80036" points="953.5,579.5547,963.5,583.5547,953.5,587.5547,957.5,583.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="504.5" x2="959.5" y1="583.5547" y2="583.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="511.5" y="578.4888">INSERT INTO trips, tickets VALUES (...)</text><polygon fill="#A80036" points="298.5,608.6875,288.5,612.6875,298.5,616.6875,294.5,612.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="292.5" x2="503.5" y1="612.6875" y2="612.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="304.5" y="607.6216">Notify about success or failure</text><polygon fill="#A80036" points="41.5,637.8203,31.5,641.8203,41.5,645.8203,37.5,641.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="286.5" y1="641.8203" y2="641.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="47.5" y="636.7544">Respond 200 with TripsId</text><rect fill="#FFFFFF" filter="url(#f7prrmk9h9nrk)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="102" x="5" y="649.8203"/><polygon fill="#EEEEEE" points="5,649.8203,71,649.8203,71,656.8203,61,666.8203,5,666.8203,5,649.8203" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="18" y="663.8872">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="11" y="682.8872">Array&lt;String&gt;</text><!--
@startuml sequence
actor Client as John
control TripController
database RouteRepository order 30
database TripsRepository order 40

John -> TripController: GET '/trips?src=?,dst=?,rest=...'
TripController -> TripService: Find Trips based on params
TripService -> RouteRepository: SELECT * FROM routes WHERE src=? AND dst=?
RouteRepository -> TripService: Return array of found Routes
TripService -> TripService: For each route: create (if possible) Trip\n based on parameters (without Passenger fields)
TripService -> TripController: Return array of Trips
TripController -> John: Respond 200 with array of Trips
ref over John: Array<TripDto> 
...
John -> TripController: POST '/trips' with body of chosen Trip\n + passengers info
ref over John: BookingRequestDto
TripController -> TripService: Save received Trip
TripService -> TripService: Process Trip
TripService -> TripsRepository: INSERT INTO trips, tickets VALUES (...)
TripService -> TripController: Notify about success or failure
TripController -> John: Respond 200 with TripsId
ref over John: Array<String>
@enduml

PlantUML version 1.2019.09(Mon Aug 26 18:19:51 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-8u252-b09-1~18.04-b09
Operating System: Linux
OS Version: 4.15.0-99-generic
Default Encoding: UTF-8
Language: pl
Country: PL
--></g></svg>